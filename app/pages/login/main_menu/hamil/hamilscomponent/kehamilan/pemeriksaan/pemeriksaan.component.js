"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var Pemeriksaan_1 = require("./Pemeriksaan");
var router_1 = require("@angular/router");
var pemeriksaan_service_1 = require("../pemeriksaan.service");
var Toast = require("nativescript-toast");
var nativescript_angular_1 = require("nativescript-angular");
var PemeriksaanComponent = (function () {
    function PemeriksaanComponent(actRoute, serv, rouex) {
        var _this = this;
        this.actRoute = actRoute;
        this.serv = serv;
        this.rouex = rouex;
        this.keadanumum = [{ key: 0, label: 'Baik' },
            { key: 1, label: 'Lemah' },
            { key: 2, label: 'Tampak Anemis' }];
        this.keadaankhusus = [{ key: 0, label: 'Tidak Ada' },
            { key: 1, label: 'Bengkak Muka/Tungkai' },
            { key: 2, label: 'Kembar Air' },
            { key: 3, label: 'Kejang-kejang' }];
        this.pone = [{ key: 0, label: '-' }, { key: 1, label: '+' }];
        this.react = [{ key: 0, label: 'non-reaktif' }, { key: 1, label: 'reaktif' }];
        this.proteinurine = ["Tidak Diperiksa", "Negatif", "+1", "+2", "Lebih dari +2 "];
        this.glukosa = ["Tidak diperiksa", "Reduksi +", "Reduksi -"];
        this.goldar = ["Belum diperiksa", "A", "B", "AB", "O"];
        this.yatak = [{ key: 0, label: 'Tidak' }, { key: 1, label: 'Ya' }];
        this.hima = [{ key: 0, label: 'mati' }, { key: 1, label: 'hidup' }];
        this.komplikasi = [
            { key: 0, label: 'HDK' },
            { key: 1, label: 'Abortus' },
            { key: 2, label: 'Perdarahan' },
            { key: 3, label: 'Infeksi' },
            { key: 4, label: 'KPD' },
            { key: 7, label: 'Sungsang' },
            { key: 5, label: 'Lainnya' },
            { key: 6, label: 'Tidak ada' }
        ];
        this.dirujuk = [
            { key: 0, label: 'Puskesmas' },
            { key: 1, label: 'Rumah sakit bersalin' },
            { key: 2, label: 'Rumah salit ibu anak' },
            { key: 3, label: 'Rumah sakit' },
            { key: 4, label: 'Lainnya' },
            { key: 5, label: 'Tidak dirujuk' }
        ];
        this.tempats = [
            "Rumah",
            "Poskesdes",
            "Pustu",
            "Puskesmas",
            "Rumah Sakit Bersalin",
            "Rumah Sakit Ibu Anak",
            "Rumah Sakit",
            "Rumah Sakit Odha",
            "Praktek mandiri",
            "Klinik"
        ];
        this.isedit = false;
        this.pemeriksaan = new Pemeriksaan_1.Pemeriksaan();
        this.actRoute.queryParams.subscribe(function (params) {
            _this.id_kehamilan = params.id_kehamilan;
            if (params.data) {
                _this.id_pemeriksaan = params.id_pemeriksaan;
                _this.pemeriksaan = JSON.parse(params.data);
                _this.isedit = true;
            }
        });
    }
    PemeriksaanComponent.prototype.save = function () {
        var _this = this;
        if (this.isedit) {
            this.serv.update(this.id_kehamilan, this.pemeriksaan.id, this.pemeriksaan).subscribe(function (res) {
                Toast.makeText(res.message).show();
                _this.rouex.backToPreviousPage();
            });
        }
        else {
            this.serv.store(this.id_kehamilan, this.pemeriksaan).subscribe(function (res) {
                Toast.makeText(res.message).show();
                _this.rouex.backToPreviousPage();
            });
        }
    };
    PemeriksaanComponent.prototype.ngOnInit = function () { };
    PemeriksaanComponent = __decorate([
        core_1.Component({
            moduleId: module.id,
            selector: 'app-pemeriksaan',
            templateUrl: './pemeriksaan.component.html',
            styleUrls: ['./pemeriksaan.component.css'],
            providers: [pemeriksaan_service_1.PemeriksaanService]
        }),
        __metadata("design:paramtypes", [router_1.ActivatedRoute,
            pemeriksaan_service_1.PemeriksaanService,
            nativescript_angular_1.RouterExtensions])
    ], PemeriksaanComponent);
    return PemeriksaanComponent;
}());
exports.PemeriksaanComponent = PemeriksaanComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGVtZXJpa3NhYW4uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsicGVtZXJpa3NhYW4uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQWtEO0FBQ2xELDZDQUEwQztBQUMxQywwQ0FBK0M7QUFDL0MsOERBQTBEO0FBQzFELDBDQUE0QztBQUM1Qyw2REFBc0Q7QUFTdEQ7SUErREksOEJBQ1ksUUFBdUIsRUFDdkIsSUFBdUIsRUFDdkIsS0FBc0I7UUFIbEMsaUJBaUJDO1FBaEJXLGFBQVEsR0FBUixRQUFRLENBQWU7UUFDdkIsU0FBSSxHQUFKLElBQUksQ0FBbUI7UUFDdkIsVUFBSyxHQUFMLEtBQUssQ0FBaUI7UUEzRGxDLGVBQVUsR0FBQyxDQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFO1lBQ2xDLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFO1lBQzFCLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsZUFBZSxFQUFFLENBQUUsQ0FBQztRQUV6QyxrQkFBYSxHQUFDLENBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7WUFDMUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxzQkFBc0IsRUFBRTtZQUN6QyxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRTtZQUMvQixFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLGVBQWUsRUFBRSxDQUFFLENBQUM7UUFFekMsU0FBSSxHQUFHLENBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxDQUFFLENBQUM7UUFFMUQsVUFBSyxHQUFHLENB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QUM7WUFDMUMsU0FBUyxFQUFFLENBQUMsd0NBQWtCLENBQUM7U0FDbEMsQ0FBQzt5Q0FpRXVCLHVCQUFjO1lBQ2xCLHdDQUFrQjtZQUNqQix1Q0FBZ0I7T0FsRXpCLG9CQUFvQixDQXdHaEM7SUFBRCwyQkFBQztDQUFBLEFBeEdELElBd0dDO0FBeEdZLG9EQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1BlbWVyaWtzYWFufSBmcm9tIFwiLi9QZW1lcmlrc2FhblwiO1xuaW1wb3J0IHtBY3RpdmF0ZWRSb3V0ZX0gZnJvbSBcIkBhbmd1bGFyL3JvdXRlclwiO1xuaW1wb3J0IHtQZW1lcmlrc2FhblNlcnZpY2V9IGZyb20gXCIuLi9wZW1lcmlrc2Fhbi5zZXJ2aWNlXCI7XG5pbXBvcnQgKiBhcyBUb2FzdCBmcm9tIFwibmF0aXZlc2NyaXB0LXRvYXN0XCI7XG5pbXBvcnQge1JvdXRlckV4dGVuc2lvbnN9IGZyb20gXCJuYXRpdmVzY3JpcHQtYW5ndWxhclwiO1xuXG5AQ29tcG9uZW50KHtcbiAgICBtb2R1bGVJZDogbW9kdWxlLmlkLFxuICAgIHNlbGVjdG9yOiAnYXBwLXBlbWVyaWtzYWFuJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vcGVtZXJpa3NhYW4uY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWycuL3BlbWVyaWtzYWFuLmNvbXBvbmVudC5jc3MnXSxcbiAgICBwcm92aWRlcnM6IFtQZW1lcmlrc2FhblNlcnZpY2VdXG59KVxuZXhwb3J0IGNsYXNzIFBlbWVyaWtzYWFuQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICAgIHBlbWVyaWtzYWFuOlBlbWVyaWtzYWFuO1xuICAgIGlkX2tlaGFtaWxhbjpudW1iZXI7XG4gICAgaWRfcGVtZXJpa3NhYW46bnVtYmVyO1xuICAgIGlzZWRpdDpib29sZWFuO1xuXG4gICAga2VhZGFudW11bT1bIHsga2V5OiAwLCBsYWJlbDogJ0JhaWsnIH0sXG4gICAgICAgIHsga2V5OiAxLCBsYWJlbDogJ0xlbWFoJyB9LFxuICAgICAgICB7IGtleTogMiwgbGFiZWw6ICdUYW1wYWsgQW5lbWlzJyB9IF07XG5cbiAgICBrZWFkYWFua2h1c3VzPVsgeyBrZXk6IDAsIGxhYmVsOiAnVGlkYWsgQWRhJyB9LFxuICAgICAgICB7IGtleTogMSwgbGFiZWw6ICdCZW5na2FrIE11a2EvVHVuZ2thaScgfSxcbiAgICAgICAgeyBrZXk6IDIsIGxhYmVsOiAnS2VtYmFyIEFpcicgfSxcbiAgICAgICAgeyBrZXk6IDMsIGxhYmVsOiAnS2VqYW5nLWtlamFuZycgfSBdO1xuXG4gICAgcG9uZSA9IFsgeyBrZXk6IDAsIGxhYmVsOiAnLScgfSwgeyBrZXk6IDEsIGxhYmVsOiAnKycgfSBdO1xuXG4gICAgcmVhY3QgPSBbIHsga2V5OiAwLCBsYWJlbDogJ25vbi1yZWFrdGlmJyB9LCB7IGtleTogMSwgbGFiZWw6ICdyZWFrdGlmJyB9IF07XG5cbiAgICBwcm90ZWludXJpbmUgPSBbXCJUaWRhayBEaXBlcmlrc2FcIixcIk5lZ2F0aWZcIixcIisxXCIsXCIrMlwiLFwiTGViaWggZGFyaSArMiBcIl07XG5cbiAgICBnbHVrb3NhID0gW1wiVGlkYWsgZGlwZXJpa3NhXCIsXCJSZWR1a3NpICtcIixcIlJlZHVrc2kgLVwiXTtcblxuICAgIGdvbGRhciA9W1wiQmVsdW0gZGlwZXJpa3NhXCIsXCJBXCIsXCJCXCIsXCJBQlwiLFwiT1wiXTtcblxuICAgIHlhdGFrID0gWyB7IGtleTogMCwgbGFiZWw6ICdUaWRhaycgfSwgeyBrZXk6IDEsIGxhYmVsOiAnWWEnIH0gXTtcblxuICAgIGhpbWEgPSBbIHsga2V5OiAwLCBsYWJlbDogJ21hdGknIH0sIHsga2V5OiAxLCBsYWJlbDogJ2hpZHVwJyB9IF07XG5cbiAgICBrb21wbGlrYXNpID0gW1xuICAgICAgICB7IGtleTogMCwgbGFiZWw6ICdIREsnIH0sXG4gICAgICAgIHsga2V5OiAxLCBsYWJlbDogJ0Fib3J0dXMnIH0sXG4gICAgICAgIHsga2V5OiAyLCBsYWJlbDogJ1BlcmRhcmFoYW4nIH0sXG4gICAgICAgIHsga2V5OiAzLCBsYWJlbDogJ0luZmVrc2knIH0sXG4gICAgICAgIHsga2V5OiA0LCBsYWJlbDogJ0tQRCcgfSxcbiAgICAgICAgeyBrZXk6IDcsIGxhYmVsOiAnU3VuZ3NhbmcnIH0sXG4gICAgICAgIHsga2V5OiA1LCBsYWJlbDogJ0xhaW5ueWEnIH0sXG4gICAgICAgIHsga2V5OiA2LCBsYWJlbDogJ1RpZGFrIGFkYScgfVxuICAgICAgICBdO1xuXG4gICAgZGlydWp1ayA9IFtcbiAgICAgICAgeyBrZXk6IDAsIGxhYmVsOiAnUHVza2VzbWFzJyB9LFxuICAgICAgICB7IGtleTogMSwgbGFiZWw6ICdSdW1haCBzYWtpdCBiZXJzYWxpbicgfSxcbiAgICAgICAgeyBrZXk6IDIsIGxhYmVsOiAnUnVtYWggc2FsaXQgaWJ1IGFuYWsnIH0sXG4gICAgICAgIHsga2V5OiAzLCBsYWJlbDogJ1J1bWFoIHNha2l0JyB9LFxuICAgICAgICB7IGtleTogNCwgbGFiZWw6ICdMYWlubnlhJyB9LFxuICAgICAgICB7IGtleTogNSwgbGFiZWw6ICdUaWRhayBkaXJ1anVrJyB9XG4gICAgXTtcblxuICAgIHRlbXBhdHMgPSBbXG4gICAgICAgIFwiUnVtYWhcIixcbiAgICAgICAgXCJQb3NrZXNkZXNcIixcbiAgICAgICAgXCJQdXN0dVwiLFxuICAgICAgICBcIlB1c2tlc21hc1wiLFxuICAgICAgICBcIlJ1bWFoIFNha2l0IEJlcnNhbGluXCIsXG4gICAgICAgIFwiUnVtYWggU2FraXQgSWJ1IEFuYWtcIixcbiAgICAgICAgXCJSdW1haCBTYWtpdFwiLFxuICAgICAgICBcIlJ1bWFoIFNha2l0IE9kaGFcIixcbiAgICAgICAgXCJQcmFrdGVrIG1hbmRpcmlcIixcbiAgICAgICAgXCJLbGluaWtcIlxuICAgIF07XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhY3RSb3V0ZTpBY3RpdmF0ZWRSb3V0ZSxcbiAgICAgICAgcHJpdmF0ZSBzZXJ2OlBlbWVyaWtzYWFuU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSByb3VleDpSb3V0ZXJFeHRlbnNpb25zXG4gICAgKSB7XG4gICAgICAgIHRoaXMuaXNlZGl0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGVtZXJpa3NhYW4gPSBuZXcgUGVtZXJpa3NhYW4oKTtcbiAgICAgICAgdGhpcy5hY3RSb3V0ZS5xdWVyeVBhcmFtcy5zdWJzY3JpYmUoXG4gICAgICAgICAgICBwYXJhbXMgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaWRfa2VoYW1pbGFuID0gcGFyYW1zLmlkX2tlaGFtaWxhbjtcbiAgICAgICAgICAgICAgICBpZiAocGFyYW1zLmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pZF9wZW1lcmlrc2FhbiA9IHBhcmFtcy5pZF9wZW1lcmlrc2FhbjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wZW1lcmlrc2FhbiA9IDxQZW1lcmlrc2Fhbj4gSlNPTi5wYXJzZShwYXJhbXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNlZGl0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc2F2ZSgpe1xuICAgICAgICBpZiAodGhpcy5pc2VkaXQpe1xuICAgICAgICAgICAgdGhpcy5zZXJ2LnVwZGF0ZSh0aGlzLmlkX2tlaGFtaWxhbix0aGlzLnBlbWVyaWtzYWFuLmlkLHRoaXMucGVtZXJpa3NhYW4pLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgICByZXMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBUb2FzdC5tYWtlVGV4dChyZXMubWVzc2FnZSkuc2hvdygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJvdWV4LmJhY2tUb1ByZXZpb3VzUGFnZSgpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICApXG4gICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgIHRoaXMuc2Vydi5zdG9yZSh0aGlzLmlkX2tlaGFtaWxhbix0aGlzLnBlbWVyaWtzYWFuKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAgICAgcmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgVG9hc3QubWFrZVRleHQocmVzLm1lc3NhZ2UpLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3VleC5iYWNrVG9QcmV2aW91c1BhZ2UoKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7IH1cblxufVxuIl19